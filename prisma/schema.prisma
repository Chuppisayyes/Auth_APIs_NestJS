generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model email_otps {
  id         Int       @id @default(autoincrement())
  email      String    @db.VarChar(255)
  otp        String    @db.VarChar(10)
  expires_at DateTime  @db.DateTime(0)
  is_used    Boolean?  @default(false)
  created_at DateTime? @default(now()) @db.Timestamp(0)
}

model refresh_tokens {
  id            Int       @id @default(autoincrement())
  user_id       Int
  refresh_token String    @db.Text
  user_agent    String?   @db.VarChar(500)
  ip_address    String?   @db.VarChar(50)
  expires_at    DateTime  @db.DateTime(0)
  created_at    DateTime? @default(now()) @db.Timestamp(0)
  users         users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "refresh_tokens_ibfk_1")

  @@index([user_id], map: "user_id")
}

model roles {
  id          Int          @id @default(autoincrement())
  name        String       @unique(map: "name") @db.VarChar(100)
  description String?      @db.VarChar(255)
  user_roles  user_roles[]
}

model user_devices {
  id          Int       @id @default(autoincrement())
  user_id     Int
  device_name String?   @db.VarChar(255)
  user_agent  String?   @db.VarChar(500)
  ip_address  String?   @db.VarChar(50)
  last_login  DateTime? @default(now()) @db.Timestamp(0)
  users       users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_devices_ibfk_1")

  @@index([user_id], map: "user_id")
}

model user_roles {
  id      Int   @id @default(autoincrement())
  user_id Int
  role_id Int
  users   users @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_roles_ibfk_1")
  roles   roles @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_roles_ibfk_2")

  @@index([role_id], map: "role_id")
  @@index([user_id], map: "user_id")
}

model users {
  id                Int              @id @default(autoincrement())
  email             String           @unique(map: "email") @db.VarChar(255)
  password          String           @db.VarChar(255)
  full_name         String?          @db.VarChar(255)
  phone             String?          @db.VarChar(20)
  avatar            String?          @db.VarChar(500)
  is_email_verified Boolean?         @default(false)
  is_active         Boolean?         @default(true)
  created_at        DateTime?        @default(now()) @db.Timestamp(0)
  updated_at        DateTime?        @default(now()) @db.Timestamp(0)
  refresh_tokens    refresh_tokens[]
  user_devices      user_devices[]
  user_roles        user_roles[]
}
